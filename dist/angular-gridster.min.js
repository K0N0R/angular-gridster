!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["angular"],t):"object"==typeof exports?module.exports=t(require("angular")):t(e.angular)}(this,function(e){"use strict";return e.module("gridster",[]).constant("gridsterConfig",{columns:6,pushing:!0,floating:!0,swapping:!1,width:"auto",colWidth:"auto",rowHeight:"match",margins:[10,10],outerMargin:!0,isMobile:!1,mobileBreakPoint:600,mobileModeEnabled:!0,minColumns:1,minRows:1,maxRows:100,defaultSizeX:2,defaultSizeY:1,minSizeX:1,maxSizeX:null,minSizeY:1,maxSizeY:null,saveGridItemCalculatedHeightInMobile:!1,resizable:{enabled:!1,handles:["s","e","n","w","se","ne","sw","nw"]},draggable:{enabled:!0,scrollSensitivity:20,scrollSpeed:15}}).controller("GridsterCtrl",["gridsterConfig","$timeout",function(t,i){var r=this;e.extend(this,t),this.resizable=e.extend({},t.resizable||{}),this.draggable=e.extend({},t.draggable||{});var n=!1;this.layoutChanged=function(){n||(n=!0,i(function(){n=!1,r.loaded&&r.floatItemsUp(),r.updateHeight(r.movingItem?r.movingItem.sizeY:0)},30))},this.grid=[],this.destroy=function(){this.grid&&(this.grid=[]),this.$element=null},this.setOptions=function(t){if(t)if(t=e.extend({},t),t.draggable&&(e.extend(this.draggable,t.draggable),delete t.draggable),t.resizable&&(e.extend(this.resizable,t.resizable),delete t.resizable),e.extend(this,t),this.margins&&2===this.margins.length)for(var i=0,r=this.margins.length;r>i;++i)this.margins[i]=parseInt(this.margins[i],10),isNaN(this.margins[i])&&(this.margins[i]=0);else this.margins=[0,0]},this.canItemOccupy=function(e,t,i){return t>-1&&i>-1&&e.sizeX+i<=this.columns&&e.sizeY+t<=this.maxRows},this.autoSetItemPosition=function(e){for(var t=0;t<this.maxRows;++t)for(var i=0;i<this.columns;++i){var r=this.getItems(t,i,e.sizeX,e.sizeY,e);if(0===r.length&&this.canItemOccupy(e,t,i))return void this.putItem(e,t,i)}throw new Error("Unable to place item!")},this.getItems=function(e,t,i,r,n){var s=[];i&&r||(i=r=1),!n||n instanceof Array||(n=[n]);for(var o=0;r>o;++o)for(var a=0;i>a;++a){var l=this.getItem(e+o,t+a,n);!l||n&&-1!==n.indexOf(l)||-1!==s.indexOf(l)||s.push(l)}return s},this.getBoundingBox=function(e){if(0===e.length)return null;if(1===e.length)return{row:e[0].row,col:e[0].col,sizeY:e[0].sizeY,sizeX:e[0].sizeX};for(var t=0,i=0,r=9999,n=9999,s=0,o=e.length;o>s;++s){var a=e[s];r=Math.min(a.row,r),n=Math.min(a.col,n),t=Math.max(a.row+a.sizeY,t),i=Math.max(a.col+a.sizeX,i)}return{row:r,col:n,sizeY:t-r,sizeX:i-n}},this.removeItem=function(e){for(var t=0,i=this.grid.length;i>t;++t){var r=this.grid[t];if(r){var n=r.indexOf(e);if(-1!==n){r[n]=null;break}}}this.layoutChanged()},this.getItem=function(e,t,i){!i||i instanceof Array||(i=[i]);for(var r=1;e>-1;){for(var n=1,s=t;s>-1;){var o=this.grid[e];if(o){var a=o[s];if(a&&(!i||-1===i.indexOf(a))&&a.sizeX>=n&&a.sizeY>=r)return a}++n,--s}--e,++r}return null},this.putItems=function(e){for(var t=0,i=e.length;i>t;++t)this.putItem(e[t])},this.putItem=function(e,t,i,r){if(("undefined"==typeof t||null===t)&&(t=e.row,i=e.col,"undefined"==typeof t||null===t))return void this.autoSetItemPosition(e);if(this.canItemOccupy(e,t,i)||(i=Math.min(this.columns-e.sizeX,Math.max(0,i)),t=Math.min(this.maxRows-e.sizeY,Math.max(0,t))),null!==e.oldRow&&"undefined"!=typeof e.oldRow){var n=e.oldRow===t&&e.oldColumn===i,s=this.grid[t]&&this.grid[t][i]===e;if(n&&s)return e.row=t,void(e.col=i);var o=this.grid[e.oldRow];o&&o[e.oldColumn]===e&&delete o[e.oldColumn]}e.oldRow=e.row=t,e.oldColumn=e.col=i,this.moveOverlappingItems(e,r),this.grid[t]||(this.grid[t]=[]),this.grid[t][i]=e,this.movingItem===e&&this.floatItemUp(e),this.layoutChanged()},this.swapItems=function(e,t){this.grid[e.row][e.col]=t,this.grid[t.row][t.col]=e;var i=e.row,r=e.col;e.row=t.row,e.col=t.col,t.row=i,t.col=r},this.moveOverlappingItems=function(e,t){t?-1===t.indexOf(e)&&(t=t.slice(0),t.push(e)):t=[e];var i=this.getItems(e.row,e.col,e.sizeX,e.sizeY,t);this.moveItemsDown(i,e.row+e.sizeY,t)},this.moveItemsDown=function(e,t,i){if(e&&0!==e.length){e.sort(function(e,t){return e.row-t.row}),i=i?i.slice(0):[];var r,n,s,o={};for(n=0,s=e.length;s>n;++n){r=e[n];var a=o[r.col];("undefined"==typeof a||r.row<a)&&(o[r.col]=r.row)}for(n=0,s=e.length;s>n;++n){r=e[n];var l=t-o[r.col];this.moveItemDown(r,r.row+l,i),i.push(r)}}},this.moveItemDown=function(e,t,i){if(!(e.row>=t)){for(;e.row<t;)++e.row,this.moveOverlappingItems(e,i);this.putItem(e,e.row,e.col,i)}},this.floatItemsUp=function(){if(this.floating!==!1)for(var e=0,t=this.grid.length;t>e;++e){var i=this.grid[e];if(i)for(var r=0,n=i.length;n>r;++r){var s=i[r];s&&this.floatItemUp(s)}}},this.floatItemUp=function(e){if(this.floating!==!1){for(var t=e.col,i=e.sizeY,r=e.sizeX,n=null,s=null,o=e.row-1;o>-1;){var a=this.getItems(o,t,r,i,e);if(0!==a.length)break;n=o,s=t,--o}null!==n&&this.putItem(e,n,s)}},this.updateHeight=function(e){var t=this.minRows;e=e||0;for(var i=this.grid.length;i>=0;--i){var r=this.grid[i];if(r)for(var n=0,s=r.length;s>n;++n)r[n]&&(t=Math.max(t,i+e+r[n].sizeY))}this.gridHeight=this.maxRows-t>0?Math.min(this.maxRows,t):Math.max(this.maxRows,t)},this.pixelsToRows=function(e,t){return this.outerMargin||(e+=this.margins[0]/2),t===!0?Math.ceil(e/this.curRowHeight):t===!1?Math.floor(e/this.curRowHeight):Math.round(e/this.curRowHeight)},this.pixelsToColumns=function(e,t){return this.outerMargin||(e+=this.margins[1]/2),t===!0?Math.ceil(e/this.curColWidth):t===!1?Math.floor(e/this.curColWidth):Math.round(e/this.curColWidth)}}]).directive("gridsterPreview",function(){return{replace:!0,scope:!0,require:"^gridster",template:'<div ng-style="previewStyle()" class="gridster-item gridster-preview-holder"></div>',link:function(e,t,i,r){e.previewStyle=function(){return r.movingItem?{display:"block",height:r.movingItem.sizeY*r.curRowHeight-r.margins[0]+"px",width:r.movingItem.sizeX*r.curColWidth-r.margins[1]+"px",top:r.movingItem.row*r.curRowHeight+(r.outerMargin?r.margins[0]:0)+"px",left:r.movingItem.col*r.curColWidth+(r.outerMargin?r.margins[1]:0)+"px"}:{display:"none"}}}}}).directive("gridster",["$timeout","$window","$rootScope","gridsterDebounce",function(t,i,r,n){return{scope:!0,restrict:"EAC",controller:"GridsterCtrl",controllerAs:"gridster",compile:function(s){return s.prepend('<div ng-if="gridster.movingItem" gridster-preview></div>'),function(s,o,a,l){function d(e){if(l.setOptions(e),h(o[0])){"auto"===l.width?l.curWidth=o[0].offsetWidth||parseInt(o.css("width"),10):l.curWidth=l.width,"auto"===l.colWidth?l.curColWidth=(l.curWidth+(l.outerMargin?-l.margins[1]:l.margins[1]))/l.columns:l.curColWidth=l.colWidth,l.curRowHeight=l.rowHeight,"string"==typeof l.rowHeight&&("match"===l.rowHeight?l.curRowHeight=Math.round(l.curColWidth):-1!==l.rowHeight.indexOf("*")?l.curRowHeight=Math.round(l.curColWidth*l.rowHeight.replace("*","").replace(" ","")):-1!==l.rowHeight.indexOf("/")&&(l.curRowHeight=Math.round(l.curColWidth/l.rowHeight.replace("/","").replace(" ","")))),l.isMobile=l.mobileModeEnabled&&l.curWidth<=l.mobileBreakPoint;for(var t=0,i=l.grid.length;i>t;++t){var r=l.grid[t];if(r)for(var n=0,s=r.length;s>n;++n)if(r[n]){var a=r[n];a.setElementPosition(),a.setElementSizeY(),a.setElementSizeX()}}u()}}function u(){o.css("height",l.gridHeight*l.curRowHeight+(l.outerMargin?l.margins[0]:-l.margins[0])+"px")}l.loaded=!1,l.$element=o,s.gridster=l,o.addClass("gridster");var h=function(e){return"hidden"!==e.style.visibility&&"none"!==e.style.display},g=a.gridster;g?s.$parent.$watch(g,function(e){d(e)},!0):d({}),s.$watch(function(){return l.loaded},function(){l.loaded?o.addClass("gridster-loaded"):o.removeClass("gridster-loaded")}),s.$watch(function(){return l.isMobile},function(){l.isMobile?o.addClass("gridster-mobile").removeClass("gridster-desktop"):o.removeClass("gridster-mobile").addClass("gridster-desktop"),r.$broadcast("gridster-mobile-changed",l)}),s.$watch(function(){return l.draggable},function(){r.$broadcast("gridster-draggable-changed",l)},!0),s.$watch(function(){return l.resizable},function(){r.$broadcast("gridster-resizable-changed",l)},!0),s.$watch(function(){return l.gridHeight},u),s.$watch(function(){return l.movingItem},function(){l.updateHeight(l.movingItem?l.movingItem.sizeY:0)});var c=o[0].offsetWidth||parseInt(o.css("width"),10),m=function(){var e=o[0].offsetWidth||parseInt(o.css("width"),10);e&&e!==c&&!l.movingItem&&(c=e,l.loaded&&o.removeClass("gridster-loaded"),d(),l.loaded&&o.addClass("gridster-loaded"),r.$broadcast("gridster-resized",[e,o[0].offsetHeight],l))},f=n(function(){m(),t(function(){s.$apply()})},100);s.$watch(function(){return h(o[0])},f),"function"==typeof window.addResizeListener?window.addResizeListener(o[0],f):s.$watch(function(){return o[0].offsetWidth||parseInt(o.css("width"),10)},m);var v=e.element(i);v.on("resize",f),s.$on("$destroy",function(){l.destroy(),v.off("resize",f),"function"==typeof window.removeResizeListener&&window.removeResizeListener(o[0],f)}),t(function(){s.$watch("gridster.floating",function(){l.floatItemsUp()}),l.loaded=!0},100)}}}}]).controller("GridsterItemCtrl",function(){this.$element=null,this.gridster=null,this.row=null,this.col=null,this.sizeX=null,this.sizeY=null,this.minSizeX=0,this.minSizeY=0,this.maxSizeX=null,this.maxSizeY=null,this.init=function(e,t){this.$element=e,this.gridster=t,this.sizeX=t.defaultSizeX,this.sizeY=t.defaultSizeY},this.destroy=function(){this.gridster=null,this.$element=null},this.toJSON=function(){return{row:this.row,col:this.col,sizeY:this.sizeY,sizeX:this.sizeX}},this.isMoving=function(){return this.gridster.movingItem===this},this.setPosition=function(e,t){this.gridster.putItem(this,e,t),this.isMoving()||this.setElementPosition()},this.setSize=function(e,t,i){e=e.toUpperCase();var r="size"+e,n="Size"+e;if(""!==t){t=parseInt(t,10),(isNaN(t)||0===t)&&(t=this.gridster["default"+n]);var s="X"===e?this.gridster.columns:this.gridster.maxRows;this["max"+n]&&(s=Math.min(this["max"+n],s)),this.gridster["max"+n]&&(s=Math.min(this.gridster["max"+n],s)),"X"===e&&this.cols?s-=this.cols:"Y"===e&&this.rows&&(s-=this.rows);var o=0;this["min"+n]&&(o=Math.max(this["min"+n],o)),this.gridster["min"+n]&&(o=Math.max(this.gridster["min"+n],o)),t=Math.max(Math.min(t,s),o);var a=this[r]!==t||this["old"+n]&&this["old"+n]!==t;return this["old"+n]=this[r]=t,this.isMoving()||this["setElement"+n](),!i&&a&&(this.gridster.moveOverlappingItems(this),this.gridster.layoutChanged()),a}},this.setSizeY=function(e,t){return this.setSize("Y",e,t)},this.setSizeX=function(e,t){return this.setSize("X",e,t)},this.setElementPosition=function(){this.gridster.isMobile?this.$element.css({marginLeft:this.gridster.margins[0]+"px",marginRight:this.gridster.margins[0]+"px",marginTop:this.gridster.margins[1]+"px",marginBottom:this.gridster.margins[1]+"px",top:"",left:""}):this.$element.css({margin:0,top:this.row*this.gridster.curRowHeight+(this.gridster.outerMargin?this.gridster.margins[0]:0)+"px",left:this.col*this.gridster.curColWidth+(this.gridster.outerMargin?this.gridster.margins[1]:0)+"px"})},this.setElementSizeY=function(){this.gridster.isMobile&&!this.gridster.saveGridItemCalculatedHeightInMobile?this.$element.css("height",""):this.$element.css("height",this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]+"px")},this.setElementSizeX=function(){this.gridster.isMobile?this.$element.css("width",""):this.$element.css("width",this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]+"px")},this.getElementSizeX=function(){return this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]},this.getElementSizeY=function(){return this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]}}).factory("GridsterTouch",[function(){return function(e,t,i,r){var n,s,o={},a=function(e){if(Object.keys)return Object.keys(e).length;var t,i=0;for(t in e)++i;return i},l=function(e){for(var t=0,i=0,r=navigator.userAgent.match(/\bMSIE\b/),n=e;null!==n;n=n.offsetParent)r&&(!document.documentMode||document.documentMode<8)&&"relative"===n.currentStyle.position&&n.offsetParent&&"relative"===n.offsetParent.currentStyle.position&&n.offsetLeft===n.offsetParent.offsetLeft?i+=n.offsetTop:(t+=n.offsetLeft,i+=n.offsetTop);return{x:t,y:i}},d=l(e),u=function(n){if("mousemove"!==n.type||0!==a(o)){for(var s=!0,g=n.changedTouches?n.changedTouches:[n],c=0;c<g.length;++c){var m=g[c],f="undefined"!=typeof m.identifier?m.identifier:"undefined"!=typeof m.pointerId?m.pointerId:1;if("undefined"==typeof m.pageX)if(m.pageX=m.offsetX+d.x,m.pageY=m.offsetY+d.y,m.srcElement.offsetParent===e&&document.documentMode&&8===document.documentMode&&"mousedown"===m.type)m.pageX+=m.srcElement.offsetLeft,m.pageY+=m.srcElement.offsetTop;else if(m.srcElement!==e&&!document.documentMode||document.documentMode<8){for(var v=-2,p=-2,w=m.srcElement;null!==w;w=w.parentNode)v+=w.scrollLeft?w.scrollLeft:0,p+=w.scrollTop?w.scrollTop:0;m.pageX=m.clientX+v,m.pageY=m.clientY+p}var z=m.pageX,b=m.pageY;n.type.match(/(start|down)$/i)?(d=l(e),o[f]&&(r&&r({target:n.target,which:n.which,pointerId:f,pageX:z,pageY:b,event:n}),delete o[f]),t&&s&&(s=t({target:n.target,which:n.which,pointerId:f,pageX:z,pageY:b,event:n})),o[f]={x:z,y:b},e.msSetPointerCapture?e.msSetPointerCapture(f):"mousedown"===n.type&&1===a(o)&&(h?e.setCapture(!0):(document.addEventListener("mousemove",u,!1),document.addEventListener("mouseup",u,!1)))):n.type.match(/move$/i)?!o[f]||o[f].x===z&&o[f].y===b||(i&&s&&(s=i({target:n.target,which:n.which,pointerId:f,pageX:z,pageY:b,event:n})),o[f].x=z,o[f].y=b):o[f]&&n.type.match(/(up|end|cancel)$/i)&&(r&&s&&(s=r({target:n.target,which:n.which,pointerId:f,pageX:z,pageY:b,event:n})),delete o[f],e.msReleasePointerCapture?e.msReleasePointerCapture(f):"mouseup"===n.type&&0===a(o)&&(h?e.releaseCapture():(document.removeEventListener("mousemove",u,!1),document.removeEventListener("mouseup",u,!1))))}s&&(n.preventDefault&&n.preventDefault(),n.preventManipulation&&n.preventManipulation(),n.preventMouseEvent&&n.preventMouseEvent())}},h=!1;return this.enable=function(){window.navigator.msPointerEnabled?(e.addEventListener("MSPointerDown",u,!1),e.addEventListener("MSPointerMove",u,!1),e.addEventListener("MSPointerUp",u,!1),e.addEventListener("MSPointerCancel",u,!1),"undefined"!=typeof e.style.msContentZooming&&(n=e.style.msContentZooming,e.style.msContentZooming="none"),"undefined"!=typeof e.style.msTouchAction&&(s=e.style.msTouchAction,e.style.msTouchAction="none")):e.addEventListener?(e.addEventListener("touchstart",u,!1),e.addEventListener("touchmove",u,!1),e.addEventListener("touchend",u,!1),e.addEventListener("touchcancel",u,!1),e.addEventListener("mousedown",u,!1),e.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(h=!0,e.addEventListener("mousemove",u,!1),e.addEventListener("mouseup",u,!1))):e.attachEvent&&e.setCapture&&(h=!0,e.attachEvent("onmousedown",function(){return u(window.event),window.event.returnValue=!1,!1}),e.attachEvent("onmousemove",function(){return u(window.event),window.event.returnValue=!1,!1}),e.attachEvent("onmouseup",function(){return u(window.event),window.event.returnValue=!1,!1}))},this.disable=function(){window.navigator.msPointerEnabled?(e.removeEventListener("MSPointerDown",u,!1),e.removeEventListener("MSPointerMove",u,!1),e.removeEventListener("MSPointerUp",u,!1),e.removeEventListener("MSPointerCancel",u,!1),n&&(e.style.msContentZooming=n),s&&(e.style.msTouchAction=s)):e.removeEventListener?(e.removeEventListener("touchstart",u,!1),e.removeEventListener("touchmove",u,!1),e.removeEventListener("touchend",u,!1),e.removeEventListener("touchcancel",u,!1),e.removeEventListener("mousedown",u,!1),e.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(h=!0,e.removeEventListener("mousemove",u,!1),e.removeEventListener("mouseup",u,!1))):e.detachEvent&&e.setCapture&&(h=!0,e.detachEvent("onmousedown"),e.detachEvent("onmousemove"),e.detachEvent("onmouseup"))},this}}]).factory("GridsterDraggable",["$document","$window","GridsterTouch","$timeout",function(t,i,r,n){function s(s,o,a,l,d){function u(e,t,i){return i>=e.top&&i<=e.bottom&&t>=e.left&&t<=e.right}function h(e){var t=e.pageX,i=e.pageY,r=$(e.target),n=r.hasScroll(),s=r.hasScroll("x"),o=null,a=null,l=!1,d=!1;return n&&(a={top:0,bottom:0,right:0,left:0},a.top=r.offset().top,a.right=r.offset().left+r.width(),a.bottom=a.top+r.height(),a.left=a.right-W,d=u(a,t,i)),s&&(o={top:0,bottom:0,right:0,left:0},o.bottom=r.offset().top+r.height(),o.left=r.offset().left,o.top=o.bottom-W,o.right=o.left+r.width(),l=u(o,t,i)),l||d}function g(t){var i=!0,r=t.target;h(t.event)&&(i=!1),$(document).on("mouseup.gridsterTimeoutHandler",function(e){i=!1,n.cancel(o),$(document).off("mouseup.gridsterTimeoutHandler")}),$(t.target).on("mouseleave.gridsterTimeoutHandler",function(e){r!=e.target&&(i=!1,n.cancel(o),$(e.target).off("mouseleave.gridsterTimeoutHandler"))});var o=n(function(){if($(document).off("mouseup.gridsterTimeoutHandler"),$(t.target).off("mouseleave.gridsterTimeoutHandler"),i){if($(".gridster-move-handler").css({"box-shadow":"black 0 0 10px -2px"}),t.target.isDragged=!0,-1!==P.indexOf(t.target.nodeName.toLowerCase()))return!1;var r=e.element(t.target);if(r.hasClass("gridster-item-resizable-handler"))return!1;if(r.attr("onclick")||r.attr("ng-click"))return!1;if(r.closest&&r.closest(".gridster-no-drag").length)return!1;switch(t.which){case 1:break;case 2:case 3:return}return C=t.pageX,S=t.pageY,w=parseInt(s.css("left"),10),z=parseInt(s.css("top"),10),b=s[0].offsetWidth,y=s[0].offsetHeight,x=l.col,I=l.row,f(t),!0}},250)}function c(e){if(!s.hasClass("gridster-item-moving")||s.hasClass("gridster-item-resizing"))return!1;var t=a.curWidth-1;Y=e.pageX,X=e.pageY;var i=Y-C+M,r=X-S+E;M=E=0,C=Y,S=X;var n=i,o=r;return H>w+n?(i=H-w,M=n-i):w+b+n>t&&(i=t-w-b,M=n-i),L>z+o?(r=L-z,E=o-r):z+y+o>T&&(r=T-z-y,E=o-r),w+=i,z+=r,s.css({top:z+"px",left:w+"px"}),v(e),!0}function m(e){return!s.hasClass("gridster-item-moving")||s.hasClass("gridster-item-resizing")?!1:(M=E=0,p(e),$(".gridster-move-handler").css({"box-shadow":"none"}),!0)}function f(e){s.addClass("gridster-item-moving"),a.movingItem=l,a.updateHeight(l.sizeY),o.$apply(function(){a.draggable&&a.draggable.start&&a.draggable.start(e,s,d)})}function v(e){var t=l.row,r=l.col,n=a.draggable&&a.draggable.drag,u=a.draggable.scrollSensitivity,h=a.draggable.scrollSpeed,g=a.pixelsToRows(z),c=a.pixelsToColumns(w),m=a.getItems(g,c,l.sizeX,l.sizeY,l),f=0!==m.length;if(a.swapping===!0&&f){var v=a.getBoundingBox(m),p=v.sizeX===l.sizeX&&v.sizeY===l.sizeY,b=v.row===t,y=v.col===r,x=v.row===g&&v.col===c,I=b||y;if(p&&1===m.length){if(x)a.swapItems(l,m[0]);else if(I)return}else if(v.sizeX<=l.sizeX&&v.sizeY<=l.sizeY&&I)for(var Y=l.row<=g?l.row:g+l.sizeY,X=l.col<=c?l.col:c+l.sizeX,C=Y-v.row,S=X-v.col,$=0,M=m.length;M>$;++$){var E=m[$],L=a.getItems(E.row+C,E.col+S,E.sizeX,E.sizeY,l);0===L.length&&a.putItem(E,E.row+C,E.col+S)}}a.pushing===!1&&f||(l.row=g,l.col=c),e.pageY-R.body.scrollTop<u?R.body.scrollTop=R.body.scrollTop-h:i.innerHeight-(e.pageY-R.body.scrollTop)<u&&(R.body.scrollTop=R.body.scrollTop+h),e.pageX-R.body.scrollLeft<u?R.body.scrollLeft=R.body.scrollLeft-h:i.innerWidth-(e.pageX-R.body.scrollLeft)<u&&(R.body.scrollLeft=R.body.scrollLeft+h),(n||t!==l.row||r!==l.col)&&o.$apply(function(){n&&a.draggable.drag(e,s,d)})}function p(e){s.removeClass("gridster-item-moving");var t=a.pixelsToRows(z),i=a.pixelsToColumns(w);(a.pushing!==!1||0===a.getItems(t,i,l.sizeX,l.sizeY,l).length)&&(l.row=t,l.col=i),a.movingItem=null,l.setPosition(l.row,l.col),o.$apply(function(){a.draggable&&a.draggable.stop&&a.draggable.stop(e,s,d)})}var w,z,b,y,x,I,Y=0,X=0,C=0,S=0,M=0,E=0,L=0,T=9999,H=0,R=t[0],P=["select","input","textarea","button"];$.fn.hasScroll=function(e){var t,i=this.css("overflow");t="undefined"==typeof e||"y"==e?this.css("overflow-y"):this.css("overflow-x");var r=this.get(0).scrollHeight>this.innerHeight(),n="auto"==i||"visible"==i||"auto"==t||"visible"==t,s="scroll"==i||"scroll"==t;return r&&n||s};var W=18,O=null,k=null,A=[];this.enable=function(){O!==!0&&(O=!0,s.ready(function(){if(O===!0){for(var t=0,i=A.length;i>t;++t)A[t].disable();A=[],a.draggable&&a.draggable.handle?(k=e.element(s[0].querySelectorAll(a.draggable.handle)),0===k.length&&(k=s)):k=s;for(var n=0,o=k.length;o>n;++n)A[n]=new r(k[n],g,c,m),A[n].enable()}}))},this.disable=function(){if(O!==!1){O=!1;for(var e=0,t=A.length;t>e;++e)A[e].disable();A=[]}},this.toggle=function(e){e?this.enable():this.disable()},this.destroy=function(){this.disable()}}return s}]).factory("GridsterResizable",["GridsterTouch",function(t){function i(i,r,n,s,o){function a(a){function l(e){switch(e.which){case 1:break;case 2:case 3:return}return b=n.draggable.enabled,b&&(n.draggable.enabled=!1,r.$broadcast("gridster-draggable-changed",n)),X=e.pageX,C=e.pageY,m=parseInt(i.css("left"),10),f=parseInt(i.css("top"),10),v=i[0].offsetWidth,p=i[0].offsetHeight,w=s.sizeX,z=s.sizeY,d(e),!0}function d(e){i.addClass("gridster-item-moving"),i.addClass("gridster-item-resizing"),n.movingItem=s,s.setElementSizeX(),s.setElementSizeY(),s.setElementPosition(),n.updateHeight(1),r.$apply(function(){n.resizable&&n.resizable.start&&n.resizable.start(e,i,o)})}function u(e){var t=n.curWidth-1;I=e.pageX,Y=e.pageY;var r=I-X+S,s=Y-C+$;S=$=0,X=I,C=Y;var o=s,a=r;return x.indexOf("n")>=0&&(p-o<T()?(s=p-T(),$=o-s):M>f+o&&(s=M-f,$=o-s),f+=s,p-=s),x.indexOf("s")>=0&&(p+o<T()?(s=T()-p,$=o-s):f+p+o>E&&(s=E-f-p,$=o-s),p+=s),x.indexOf("w")>=0&&(v-a<H()?(r=v-H(),S=a-r):L>m+a&&(r=L-m,S=a-r),m+=r,v-=r),x.indexOf("e")>=0&&(v+a<H()?(r=H()-v,S=a-r):m+v+a>t&&(r=t-m-v,S=a-r),v+=r),i.css({top:f+"px",left:m+"px",width:v+"px",height:p+"px"}),g(e),!0}function h(e){return n.draggable.enabled!==b&&(n.draggable.enabled=b,r.$broadcast("gridster-draggable-changed",n)),S=$=0,c(e),!0}function g(e){var t=s.row,l=s.col,d=s.sizeX,u=s.sizeY,h=n.resizable&&n.resizable.resize,g=s.col;-1!==["w","nw","sw"].indexOf(a)&&(g=n.pixelsToColumns(m,!1));var c=s.row;-1!==["n","ne","nw"].indexOf(a)&&(c=n.pixelsToRows(f,!1));var w=s.sizeX;-1===["n","s"].indexOf(a)&&(w=n.pixelsToColumns(v,!0));var z=s.sizeY;-1===["e","w"].indexOf(a)&&(z=n.pixelsToRows(p,!0));var b=c>-1&&g>-1&&w+g<=n.columns&&z+c<=n.maxRows;!b||n.pushing===!1&&0!==n.getItems(c,g,w,z,s).length||(s.row=c,s.col=g,s.sizeX=w,s.sizeY=z);var y=s.row!==t||s.col!==l||s.sizeX!==d||s.sizeY!==u;(h||y)&&r.$apply(function(){h&&n.resizable.resize(e,i,o)})}function c(e){i.removeClass("gridster-item-moving"),i.removeClass("gridster-item-resizing"),n.movingItem=null,s.setPosition(s.row,s.col),s.setSizeY(s.sizeY),s.setSizeX(s.sizeX),r.$apply(function(){n.resizable&&n.resizable.stop&&n.resizable.stop(e,i,o)})}var m,f,v,p,w,z,b,y,x=a,I=0,Y=0,X=0,C=0,S=0,$=0,M=0,E=9999,L=0,T=function(){return(s.minSizeY?s.minSizeY:1)*n.curRowHeight-n.margins[0]},H=function(){return(s.minSizeX?s.minSizeX:1)*n.curColWidth-n.margins[1]},R=null;this.enable=function(){R||(R=e.element('<div class="gridster-item-resizable-handler handle-'+x+'"></div>'),i.append(R)),y=new t(R[0],l,u,h),y.enable()},this.disable=function(){R&&(R.remove(),R=null),y.disable(),y=void 0},this.destroy=function(){this.disable()}}var l=[],d=n.resizable.handles;"string"==typeof d&&(d=n.resizable.handles.split(","));for(var u=!1,h=0,g=d.length;g>h;h++)l.push(new a(d[h]));this.enable=function(){if(!u){for(var e=0,t=l.length;t>e;e++)l[e].enable();u=!0}},this.disable=function(){if(u){for(var e=0,t=l.length;t>e;e++)l[e].disable();u=!1}},this.toggle=function(e){e?this.enable():this.disable()},this.destroy=function(){for(var e=0,t=l.length;t>e;e++)l[e].destroy()}}return i}]).factory("gridsterDebounce",function(){return function(e,t,i){var r;return function(){var n=this,s=arguments,o=function(){r=null,i||e.apply(n,s)},a=i&&!r;clearTimeout(r),r=setTimeout(o,t),a&&e.apply(n,s)}}}).directive("gridsterItem",["$parse","GridsterDraggable","GridsterResizable","gridsterDebounce","$rootScope",function(e,t,i,r,n){return{scope:!0,restrict:"EA",controller:"GridsterItemCtrl",controllerAs:"gridsterItem",require:["^gridster","gridsterItem"],link:function(s,o,a,l){function d(){f.setPosition(f.row,f.col),w.row&&w.row.assign&&w.row.assign(s,f.row),w.col&&w.col.assign&&w.col.assign(s,f.col),X&&n.$broadcast("gridster-transition",f,m)}function u(){var e=f.setSizeX(f.sizeX,!0);e&&w.sizeX&&w.sizeX.assign&&w.sizeX.assign(s,f.sizeX);var t=f.setSizeY(f.sizeY,!0);t&&w.sizeY&&w.sizeY.assign&&w.sizeY.assign(s,f.sizeY),(e||t)&&(f.gridster.moveOverlappingItems(f),m.layoutChanged())}function h(){var e=document.createElement("div"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var i in t)if(void 0!==e.style[i])return t[i]}var g,c=a.gridsterItem,m=l[0],f=l[1];if(s.gridster=m,c){var v=e(c);g=v(s)||{},!g&&v.assign&&(g={row:f.row,col:f.col,sizeX:f.sizeX,sizeY:f.sizeY,minSizeX:0,minSizeY:0,maxSizeX:null,maxSizeY:null},v.assign(s,g))}else g=a;f.init(o,m),o.addClass("gridster-item");for(var p=["minSizeX","maxSizeX","minSizeY","maxSizeY","sizeX","sizeY","row","col"],w={},z=[],b=function(t){var i;if("string"==typeof g[t])i=g[t];else if("string"==typeof g[t.toLowerCase()])i=g[t.toLowerCase()];else{if(!c)return;i=c+"."+t}z.push('"'+t+'":'+i),w[t]=e(i);var r=w[t](s);"number"==typeof r&&(f[t]=r)},y=0,x=p.length;x>y;++y)b(p[y]);var I="{"+z.join(",")+"}";s.$watchCollection(I,function(e,t){for(var i in e){var r=e[i],n=t[i];n!==r&&(r=parseInt(r,10),isNaN(r)||(f[i]=r))}});var Y,X=!0;$(window).resize(function(){X=!1,clearTimeout(Y),Y=setTimeout(function(){X=!0},1e3)}),s.$watch(function(){return f.row+","+f.col},d),s.$watch(function(){return f.sizeY+","+f.sizeX+","+f.minSizeX+","+f.maxSizeX+","+f.minSizeY+","+f.maxSizeY},u);var C=new t(o,s,m,f,g),S=new i(o,s,m,f,g),M=function(){};M();var E=function(){C.toggle(!m.isMobile&&m.draggable&&m.draggable.enabled)};E(),s.$on("gridster-draggable-changed",E),s.$on("gridster-resizable-changed",M),s.$on("gridster-resized",M),s.$on("gridster-mobile-changed",function(){M(),E()});var L=r(function(){s.$apply(function(){n.$broadcast("gridster-item-transition-end",f,m)})},50);return o.on(h(),L),s.$broadcast("gridster-item-initialized",f),s.$on("$destroy",function(){try{S.destroy(),C.destroy()}catch(e){}try{m.removeItem(f)}catch(e){}try{f.destroy()}catch(e){}})}}}]).directive("gridsterNoDrag",function(){return{restrict:"A",link:function(e,t){t.addClass("gridster-no-drag")}}})});