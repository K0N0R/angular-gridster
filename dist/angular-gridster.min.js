!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["angular"],t):"object"==typeof exports?module.exports=t(require("angular")):t(e.angular)}(this,function(e){"use strict";return e.module("gridster",[]).constant("gridsterConfig",{columns:6,pushing:!0,floating:!0,swapping:!1,width:"auto",colWidth:"auto",rowHeight:"match",margins:[10,10],outerMargin:!0,isMobile:!1,mobileBreakPoint:600,mobileModeEnabled:!0,minColumns:1,minRows:1,maxRows:100,defaultSizeX:2,defaultSizeY:1,minSizeX:1,maxSizeX:null,minSizeY:1,maxSizeY:null,saveGridItemCalculatedHeightInMobile:!1,resizable:{enabled:!1,handles:["s","e","n","w","se","ne","sw","nw"]},draggable:{enabled:!0,scrollSensitivity:20,scrollSpeed:15}}).controller("GridsterCtrl",["gridsterConfig","$timeout",function(t,i){var r=this;e.extend(this,t),this.resizable=e.extend({},t.resizable||{}),this.draggable=e.extend({},t.draggable||{});var n=!1;this.layoutChanged=function(){n||(n=!0,i(function(){n=!1,r.loaded&&r.floatItemsUp(),r.updateHeight(r.movingItem?r.movingItem.sizeY:0)},30))},this.grid=[],this.destroy=function(){this.grid&&(this.grid=[]),this.$element=null},this.setOptions=function(t){if(t)if((t=e.extend({},t)).draggable&&(e.extend(this.draggable,t.draggable),delete t.draggable),t.resizable&&(e.extend(this.resizable,t.resizable),delete t.resizable),e.extend(this,t),this.margins&&2===this.margins.length)for(var i=0,r=this.margins.length;i<r;++i)this.margins[i]=parseInt(this.margins[i],10),isNaN(this.margins[i])&&(this.margins[i]=0);else this.margins=[0,0]},this.canItemOccupy=function(e,t,i){return t>-1&&i>-1&&e.sizeX+i<=this.columns&&e.sizeY+t<=this.maxRows},this.autoSetItemPosition=function(e){for(var t=0;t<this.maxRows;++t)for(var i=0;i<this.columns;++i){if(0===this.getItems(t,i,e.sizeX,e.sizeY,e).length&&this.canItemOccupy(e,t,i))return void this.putItem(e,t,i)}throw new Error("Unable to place item!")},this.getItems=function(e,t,i,r,n){var s=[];i&&r||(i=r=1),!n||n instanceof Array||(n=[n]);for(var o=0;o<r;++o)for(var a=0;a<i;++a){var l=this.getItem(e+o,t+a,n);!l||n&&-1!==n.indexOf(l)||-1!==s.indexOf(l)||s.push(l)}return s},this.getBoundingBox=function(e){if(0===e.length)return null;if(1===e.length)return{row:e[0].row,col:e[0].col,sizeY:e[0].sizeY,sizeX:e[0].sizeX};for(var t=0,i=0,r=9999,n=9999,s=0,o=e.length;s<o;++s){var a=e[s];r=Math.min(a.row,r),n=Math.min(a.col,n),t=Math.max(a.row+a.sizeY,t),i=Math.max(a.col+a.sizeX,i)}return{row:r,col:n,sizeY:t-r,sizeX:i-n}},this.removeItem=function(e){for(var t=0,i=this.grid.length;t<i;++t){var r=this.grid[t];if(r){var n=r.indexOf(e);if(-1!==n){r[n]=null;break}}}this.layoutChanged()},this.getItem=function(e,t,i){!i||i instanceof Array||(i=[i]);for(var r=1;e>-1;){for(var n=1,s=t;s>-1;){var o=this.grid[e];if(o){var a=o[s];if(a&&(!i||-1===i.indexOf(a))&&a.sizeX>=n&&a.sizeY>=r)return a}++n,--s}--e,++r}return null},this.putItems=function(e){for(var t=0,i=e.length;t<i;++t)this.putItem(e[t])},this.putItem=function(e,t,i,r){if(void 0!==t&&null!==t||(t=e.row,i=e.col,void 0!==t&&null!==t)){if(this.canItemOccupy(e,t,i)||(i=Math.min(this.columns-e.sizeX,Math.max(0,i)),t=Math.min(this.maxRows-e.sizeY,Math.max(0,t))),null!==e.oldRow&&void 0!==e.oldRow){var n=e.oldRow===t&&e.oldColumn===i,s=this.grid[t]&&this.grid[t][i]===e;if(n&&s)return e.row=t,void(e.col=i);var o=this.grid[e.oldRow];o&&o[e.oldColumn]===e&&delete o[e.oldColumn]}e.oldRow=e.row=t,e.oldColumn=e.col=i,this.moveOverlappingItems(e,r),this.grid[t]||(this.grid[t]=[]),this.grid[t][i]=e,this.movingItem===e&&this.floatItemUp(e),this.layoutChanged()}else this.autoSetItemPosition(e)},this.swapItems=function(e,t){this.grid[e.row][e.col]=t,this.grid[t.row][t.col]=e;var i=e.row,r=e.col;e.row=t.row,e.col=t.col,t.row=i,t.col=r},this.moveOverlappingItems=function(e,t){t?-1===t.indexOf(e)&&(t=t.slice(0)).push(e):t=[e];var i=this.getItems(e.row,e.col,e.sizeX,e.sizeY,t);this.moveItemsDown(i,e.row+e.sizeY,t)},this.moveItemsDown=function(e,t,i){if(e&&0!==e.length){e.sort(function(e,t){return e.row-t.row}),i=i?i.slice(0):[];var r,n,s,o={};for(n=0,s=e.length;n<s;++n){var a=o[(r=e[n]).col];(void 0===a||r.row<a)&&(o[r.col]=r.row)}for(n=0,s=e.length;n<s;++n){var l=t-o[(r=e[n]).col];this.moveItemDown(r,r.row+l,i),i.push(r)}}},this.moveItemDown=function(e,t,i){if(!(e.row>=t)){for(;e.row<t;)++e.row,this.moveOverlappingItems(e,i);this.putItem(e,e.row,e.col,i)}},this.floatItemsUp=function(){if(!1!==this.floating)for(var e=0,t=this.grid.length;e<t;++e){var i=this.grid[e];if(i)for(var r=0,n=i.length;r<n;++r){var s=i[r];s&&this.floatItemUp(s)}}},this.floatItemUp=function(e){if(!1!==this.floating){for(var t=e.col,i=e.sizeY,r=e.sizeX,n=null,s=null,o=e.row-1;o>-1;){if(0!==this.getItems(o,t,r,i,e).length)break;n=o,s=t,--o}null!==n&&this.putItem(e,n,s)}},this.updateHeight=function(e){var t=this.minRows;e=e||0;for(var i=this.grid.length;i>=0;--i){var r=this.grid[i];if(r)for(var n=0,s=r.length;n<s;++n)r[n]&&(t=Math.max(t,i+e+r[n].sizeY))}this.gridHeight=this.maxRows-t>0?Math.min(this.maxRows,t):Math.max(this.maxRows,t)},this.pixelsToRows=function(e,t){return this.outerMargin||(e+=this.margins[0]/2),!0===t?Math.ceil(e/this.curRowHeight):!1===t?Math.floor(e/this.curRowHeight):Math.round(e/this.curRowHeight)},this.pixelsToColumns=function(e,t){return this.outerMargin||(e+=this.margins[1]/2),!0===t?Math.ceil(e/this.curColWidth):!1===t?Math.floor(e/this.curColWidth):Math.round(e/this.curColWidth)}}]).directive("gridsterPreview",function(){return{replace:!0,scope:!0,require:"^gridster",template:'<div ng-style="previewStyle()" class="gridster-item gridster-preview-holder"></div>',link:function(e,t,i,r){e.previewStyle=function(){return r.movingItem?{display:"block",height:r.movingItem.sizeY*r.curRowHeight-r.margins[0]+"px",width:r.movingItem.sizeX*r.curColWidth-r.margins[1]+"px",top:r.movingItem.row*r.curRowHeight+(r.outerMargin?r.margins[0]:0)+"px",left:r.movingItem.col*r.curColWidth+(r.outerMargin?r.margins[1]:0)+"px"}:{display:"none"}}}}}).directive("gridster",["$timeout","$window","$rootScope","gridsterDebounce",function(t,i,r,n){return{scope:!0,restrict:"EAC",controller:"GridsterCtrl",controllerAs:"gridster",compile:function(s){return s.prepend('<div ng-if="gridster.movingItem" gridster-preview></div>'),function(s,o,a,l){l.loaded=!1,l.$element=o,s.gridster=l,o.addClass("gridster");var d=function(e){return"hidden"!==e.style.visibility&&"none"!==e.style.display};function h(e){if(l.setOptions(e),d(o[0])){"auto"===l.width?l.curWidth=o[0].offsetWidth||parseInt(o.css("width"),10):l.curWidth=l.width,"auto"===l.colWidth?l.curColWidth=(l.curWidth+(l.outerMargin?-l.margins[1]:l.margins[1]))/l.columns:l.curColWidth=l.colWidth,l.curRowHeight=l.rowHeight,"string"==typeof l.rowHeight&&("match"===l.rowHeight?l.curRowHeight=Math.round(l.curColWidth):-1!==l.rowHeight.indexOf("*")?l.curRowHeight=Math.round(l.curColWidth*l.rowHeight.replace("*","").replace(" ","")):-1!==l.rowHeight.indexOf("/")&&(l.curRowHeight=Math.round(l.curColWidth/l.rowHeight.replace("/","").replace(" ","")))),l.isMobile=l.mobileModeEnabled&&l.curWidth<=l.mobileBreakPoint;for(var t=0,i=l.grid.length;t<i;++t){var r=l.grid[t];if(r)for(var n=0,s=r.length;n<s;++n)if(r[n]){var a=r[n];a.setElementPosition(),a.setElementSizeY(),a.setElementSizeX()}}u()}}var c=a.gridster;function u(){o.css("height",l.gridHeight*l.curRowHeight+(l.outerMargin?l.margins[0]:-l.margins[0])+"px")}c?s.$parent.$watch(c,function(e){h(e)},!0):h({}),s.$watch(function(){return l.loaded},function(){l.loaded?o.addClass("gridster-loaded"):o.removeClass("gridster-loaded")}),s.$watch(function(){return l.isMobile},function(){l.isMobile?o.addClass("gridster-mobile").removeClass("gridster-desktop"):o.removeClass("gridster-mobile").addClass("gridster-desktop"),r.$broadcast("gridster-mobile-changed",l)}),s.$watch(function(){return l.draggable},function(){r.$broadcast("gridster-draggable-changed",l)},!0),s.$watch(function(){return l.resizable},function(){r.$broadcast("gridster-resizable-changed",l)},!0),s.$watch(function(){return l.gridHeight},u),s.$watch(function(){return l.movingItem},function(){l.updateHeight(l.movingItem?l.movingItem.sizeY:0)});var g=o[0].offsetWidth||parseInt(o.css("width"),10),m=function(){var e=o[0].offsetWidth||parseInt(o.css("width"),10);e&&e!==g&&!l.movingItem&&(g=e,l.loaded&&o.removeClass("gridster-loaded"),h(),l.loaded&&o.addClass("gridster-loaded"),r.$broadcast("gridster-resized",[e,o[0].offsetHeight],l))},f=n(function(){m(),t(function(){s.$apply()})},100);s.$watch(function(){return d(o[0])},f),"function"==typeof window.addResizeListener?window.addResizeListener(o[0],f):s.$watch(function(){return o[0].offsetWidth||parseInt(o.css("width"),10)},m);var v=e.element(i);v.on("resize",f),s.$on("$destroy",function(){l.destroy(),v.off("resize",f),"function"==typeof window.removeResizeListener&&window.removeResizeListener(o[0],f)}),t(function(){s.$watch("gridster.floating",function(){l.floatItemsUp()}),l.loaded=!0},100)}}}}]).controller("GridsterItemCtrl",function(){this.$element=null,this.gridster=null,this.row=null,this.col=null,this.sizeX=null,this.sizeY=null,this.minSizeX=0,this.minSizeY=0,this.maxSizeX=null,this.maxSizeY=null,this.init=function(e,t){this.$element=e,this.gridster=t,this.sizeX=t.defaultSizeX,this.sizeY=t.defaultSizeY},this.destroy=function(){this.gridster=null,this.$element=null},this.toJSON=function(){return{row:this.row,col:this.col,sizeY:this.sizeY,sizeX:this.sizeX}},this.isMoving=function(){return this.gridster.movingItem===this},this.setPosition=function(e,t){this.gridster.putItem(this,e,t),this.isMoving()||this.setElementPosition()},this.setSize=function(e,t,i){var r="size"+(e=e.toUpperCase()),n="Size"+e;if(""!==t){t=parseInt(t,10),(isNaN(t)||0===t)&&(t=this.gridster["default"+n]);var s="X"===e?this.gridster.columns:this.gridster.maxRows;this["max"+n]&&(s=Math.min(this["max"+n],s)),this.gridster["max"+n]&&(s=Math.min(this.gridster["max"+n],s)),"X"===e&&this.cols?s-=this.cols:"Y"===e&&this.rows&&(s-=this.rows);var o=0;this["min"+n]&&(o=Math.max(this["min"+n],o)),this.gridster["min"+n]&&(o=Math.max(this.gridster["min"+n],o)),t=Math.max(Math.min(t,s),o);var a=this[r]!==t||this["old"+n]&&this["old"+n]!==t;return this["old"+n]=this[r]=t,this.isMoving()||this["setElement"+n](),!i&&a&&(this.gridster.moveOverlappingItems(this),this.gridster.layoutChanged()),a}},this.setSizeY=function(e,t){return this.setSize("Y",e,t)},this.setSizeX=function(e,t){return this.setSize("X",e,t)},this.setElementPosition=function(){this.gridster.isMobile?this.$element.css({marginLeft:this.gridster.margins[0]+"px",marginRight:this.gridster.margins[0]+"px",marginTop:this.gridster.margins[1]+"px",marginBottom:this.gridster.margins[1]+"px",top:"",left:""}):this.$element.css({margin:0,top:this.row*this.gridster.curRowHeight+(this.gridster.outerMargin?this.gridster.margins[0]:0)+"px",left:this.col*this.gridster.curColWidth+(this.gridster.outerMargin?this.gridster.margins[1]:0)+"px"})},this.setElementSizeY=function(){this.gridster.isMobile&&!this.gridster.saveGridItemCalculatedHeightInMobile?this.$element.css("height",""):this.$element.css("height",this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]+"px")},this.setElementSizeX=function(){this.gridster.isMobile?this.$element.css("width",""):this.$element.css("width",this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]+"px")},this.getElementSizeX=function(){return this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]},this.getElementSizeY=function(){return this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]}}).factory("GridsterTouch",[function(){return function(e,t,i,r){var n,s,o={},a=function(e){if(Object.keys)return Object.keys(e).length;var t,i=0;for(t in e)++i;return i},l=function(e){for(var t=0,i=0,r=navigator.userAgent.match(/\bMSIE\b/),n=e;null!==n;n=n.offsetParent)r&&(!document.documentMode||document.documentMode<8)&&"relative"===n.currentStyle.position&&n.offsetParent&&"relative"===n.offsetParent.currentStyle.position&&n.offsetLeft===n.offsetParent.offsetLeft?i+=n.offsetTop:(t+=n.offsetLeft,i+=n.offsetTop);return{x:t,y:i}},d=l(e),h=function(n){if("mousemove"!==n.type||0!==a(o)){for(var s=!0,u=n.changedTouches?n.changedTouches:[n],g=0;g<u.length;++g){var m=u[g],f=void 0!==m.identifier?m.identifier:void 0!==m.pointerId?m.pointerId:1;if(void 0===m.pageX)if(m.pageX=m.offsetX+d.x,m.pageY=m.offsetY+d.y,m.srcElement.offsetParent===e&&document.documentMode&&8===document.documentMode&&"mousedown"===m.type)m.pageX+=m.srcElement.offsetLeft,m.pageY+=m.srcElement.offsetTop;else if(m.srcElement!==e&&!document.documentMode||document.documentMode<8){for(var v=-2,p=-2,w=m.srcElement;null!==w;w=w.parentNode)v+=w.scrollLeft?w.scrollLeft:0,p+=w.scrollTop?w.scrollTop:0;m.pageX=m.clientX+v,m.pageY=m.clientY+p}var z=m.pageX,b=m.pageY;n.type.match(/(start|down)$/i)?(d=l(e),o[f]&&(r&&r({target:n.target,which:n.which,pointerId:f,pageX:z,pageY:b,event:n}),delete o[f]),t&&s&&(s=t({target:n.target,which:n.which,pointerId:f,pageX:z,pageY:b,event:n})),o[f]={x:z,y:b},e.msSetPointerCapture?e.msSetPointerCapture(f):"mousedown"===n.type&&1===a(o)&&(c?e.setCapture(!0):(document.addEventListener("mousemove",h,!1),document.addEventListener("mouseup",h,!1)))):n.type.match(/move$/i)?!o[f]||o[f].x===z&&o[f].y===b||(i&&s&&(s=i({target:n.target,which:n.which,pointerId:f,pageX:z,pageY:b,event:n})),o[f].x=z,o[f].y=b):o[f]&&n.type.match(/(up|end|cancel)$/i)&&(r&&s&&(s=r({target:n.target,which:n.which,pointerId:f,pageX:z,pageY:b,event:n})),delete o[f],e.msReleasePointerCapture?e.msReleasePointerCapture(f):"mouseup"===n.type&&0===a(o)&&(c?e.releaseCapture():(document.removeEventListener("mousemove",h,!1),document.removeEventListener("mouseup",h,!1))))}s&&(n.preventDefault&&n.preventDefault(),n.preventManipulation&&n.preventManipulation(),n.preventMouseEvent&&n.preventMouseEvent())}},c=!1;return this.enable=function(){window.navigator.msPointerEnabled?(e.addEventListener("MSPointerDown",h,!1),e.addEventListener("MSPointerMove",h,!1),e.addEventListener("MSPointerUp",h,!1),e.addEventListener("MSPointerCancel",h,!1),void 0!==e.style.msContentZooming&&(n=e.style.msContentZooming,e.style.msContentZooming="none"),void 0!==e.style.msTouchAction&&(s=e.style.msTouchAction,e.style.msTouchAction="none")):e.addEventListener?(e.addEventListener("touchstart",h,!1),e.addEventListener("touchmove",h,!1),e.addEventListener("touchend",h,!1),e.addEventListener("touchcancel",h,!1),e.addEventListener("mousedown",h,!1),e.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(c=!0,e.addEventListener("mousemove",h,!1),e.addEventListener("mouseup",h,!1))):e.attachEvent&&e.setCapture&&(c=!0,e.attachEvent("onmousedown",function(){return h(window.event),window.event.returnValue=!1,!1}),e.attachEvent("onmousemove",function(){return h(window.event),window.event.returnValue=!1,!1}),e.attachEvent("onmouseup",function(){return h(window.event),window.event.returnValue=!1,!1}))},this.disable=function(){window.navigator.msPointerEnabled?(e.removeEventListener("MSPointerDown",h,!1),e.removeEventListener("MSPointerMove",h,!1),e.removeEventListener("MSPointerUp",h,!1),e.removeEventListener("MSPointerCancel",h,!1),n&&(e.style.msContentZooming=n),s&&(e.style.msTouchAction=s)):e.removeEventListener?(e.removeEventListener("touchstart",h,!1),e.removeEventListener("touchmove",h,!1),e.removeEventListener("touchend",h,!1),e.removeEventListener("touchcancel",h,!1),e.removeEventListener("mousedown",h,!1),e.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(c=!0,e.removeEventListener("mousemove",h,!1),e.removeEventListener("mouseup",h,!1))):e.detachEvent&&e.setCapture&&(c=!0,e.detachEvent("onmousedown"),e.detachEvent("onmousemove"),e.detachEvent("onmouseup"))},this}}]).factory("GridsterDraggable",["$document","$window","GridsterTouch","$timeout",function(t,i,r,n){return function(s,o,a,l,d){var h,c,u,g,m=0,f=0,v=0,p=0,w=0,z=0,b=0,y=9999,x=0,I=t[0],Y=["select","input","textarea","button"];function C(e,t,i){return i>=e.top&&i<=e.bottom&&t>=e.left&&t<=e.right}$.fn.hasScroll=function(e){var t,i=this.css("overflow");return t=void 0===e||"y"==e?this.css("overflow-y"):this.css("overflow-x"),this.get(0).scrollHeight>this.innerHeight()&&("auto"==i||"visible"==i||"auto"==t||"visible"==t)||"scroll"==i||"scroll"==t};var X=18,S=$(".dashboard").scrollTop();function M(t){var i,r,m,f,w,z,b,y,x,I,M=!0,E=t.target;i=t.event,r=i.pageX,m=i.pageY,f=$(i.target),w=f.hasScroll(),z=f.hasScroll("x"),b=null,y=null,x=!1,I=!1,w&&((y={top:0,bottom:0,right:0,left:0}).top=f.offset().top,y.right=f.offset().left+f.width(),y.bottom=y.top+f.height(),y.left=y.right-X,I=C(y,r,m)),z&&((b={top:0,bottom:0,right:0,left:0}).bottom=f.offset().top+f.height(),b.left=f.offset().left,b.top=b.bottom-X,b.right=b.left+f.width(),x=C(b,r,m)),(x||I)&&(M=!1),$(document).off("mouseup.gridsterTimeoutHandler"),$(document).on("mouseup.gridsterTimeoutHandler",function(e){M=!1,n.cancel(T),$(document).off("mouseup.gridsterTimeoutHandler")}),$(E).off("mouseleave.gridsterTimeoutHandler"),$(E).on("mouseleave.gridsterTimeoutHandler",function(e){E!=e.target&&(M=!1,n.cancel(T),$(E).off("mouseleave.gridsterTimeoutHandler"))});var T=n(function(){if($(document).off("mouseup.gridsterTimeoutHandler"),$(E).off("mouseleave.gridsterTimeoutHandler"),M){if(S=$(".dashboard").scrollTop(),$(".gridster-move-handler").addClass("--active"),-1!==Y.indexOf(E.nodeName.toLowerCase()))return!1;var i=e.element(E);if(i.hasClass("gridster-item-resizable-handler"))return!1;if(i.attr("onclick")||i.attr("ng-click"))return!1;if(i.closest&&i.closest(".gridster-no-drag").length)return!1;switch(t.which){case 1:break;case 2:case 3:return}return v=t.pageX,p=t.pageY,h=parseInt(s.css("left"),10),c=parseInt(s.css("top"),10),u=s[0].offsetWidth,g=s[0].offsetHeight,l.col,l.row,r=t,s.addClass("gridster-item-moving"),a.movingItem=l,a.updateHeight(l.sizeY),o.$apply(function(){a.draggable&&a.draggable.start&&a.draggable.start(r,s,d)}),!0}var r},250)}function E(e){if(!s.hasClass("gridster-item-moving")||s.hasClass("gridster-item-resizing"))return!1;var t=a.curWidth-1;m=e.pageX,f=e.pageY;var r=m-v+w,n=f-p+z;w=z=0,v=m,p=f;var Y=r,C=n;h+Y<x?w=Y-(r=x-h):h+u+Y>t&&(w=Y-(r=t-h-u)),c+C<b?z=C-(n=b-c):c+g+C>y&&(z=C-(n=y-c-g)),h+=r,c+=n;var X=0,M=$(".dashboard").scrollTop();return M!=S&&(X=M-S,S=M),c+=X,s.css({top:c+"px",left:h+"px"}),function(e){var t=l.row,r=l.col,n=a.draggable&&a.draggable.drag,u=a.draggable.scrollSensitivity,g=a.draggable.scrollSpeed,m=a.pixelsToRows(c),f=a.pixelsToColumns(h),v=a.getItems(m,f,l.sizeX,l.sizeY,l),p=0!==v.length;if(!0===a.swapping&&p){var w=a.getBoundingBox(v),z=w.sizeX===l.sizeX&&w.sizeY===l.sizeY,b=w.row===t,y=w.col===r,x=w.row===m&&w.col===f,Y=b||y;if(z&&1===v.length){if(x)a.swapItems(l,v[0]);else if(Y)return}else if(w.sizeX<=l.sizeX&&w.sizeY<=l.sizeY&&Y)for(var C=l.row<=m?l.row:m+l.sizeY,X=l.col<=f?l.col:f+l.sizeX,$=C-w.row,S=X-w.col,M=0,E=v.length;M<E;++M){var T=v[M],L=a.getItems(T.row+$,T.col+S,T.sizeX,T.sizeY,l);0===L.length&&a.putItem(T,T.row+$,T.col+S)}}!1===a.pushing&&p||(l.row=m,l.col=f),e.pageY-I.body.scrollTop<u?I.body.scrollTop=I.body.scrollTop-g:i.innerHeight-(e.pageY-I.body.scrollTop)<u&&(I.body.scrollTop=I.body.scrollTop+g),e.pageX-I.body.scrollLeft<u?I.body.scrollLeft=I.body.scrollLeft-g:i.innerWidth-(e.pageX-I.body.scrollLeft)<u&&(I.body.scrollLeft=I.body.scrollLeft+g),(n||t!==l.row||r!==l.col)&&o.$apply(function(){n&&a.draggable.drag(e,s,d)})}(e),!0}function T(e){return!(!s.hasClass("gridster-item-moving")||s.hasClass("gridster-item-resizing")||(w=z=0,function(e){s.removeClass("gridster-item-moving");var t=a.pixelsToRows(c),i=a.pixelsToColumns(h);!1===a.pushing&&0!==a.getItems(t,i,l.sizeX,l.sizeY,l).length||(l.row=t,l.col=i),a.movingItem=null,l.setPosition(l.row,l.col),o.$apply(function(){a.draggable&&a.draggable.stop&&a.draggable.stop(e,s,d)})}(e),$(".gridster-move-handler").removeClass("--active"),0))}var L=null,H=null,R=[];this.enable=function(){!0!==L&&(L=!0,s.ready(function(){if(!0===L){for(var t=0,i=R.length;t<i;++t)R[t].disable();R=[],a.draggable&&a.draggable.handle?0===(H=e.element(s[0].querySelectorAll(a.draggable.handle))).length&&(H=s):H=s;for(var n=0,o=H.length;n<o;++n)R[n]=new r(H[n],M,E,T),R[n].enable()}}))},this.disable=function(){if(!1!==L){L=!1;for(var e=0,t=R.length;e<t;++e)R[e].disable();R=[]}},this.toggle=function(e){e?this.enable():this.disable()},this.destroy=function(){this.disable()}}}]).factory("GridsterResizable",["GridsterTouch",function(t){return function(i,r,n,s,o){function a(a){var l,d,h,c,u,g=a,m=0,f=0,v=0,p=0,w=0,z=0,b=0,y=9999,x=0,I=function(){return(s.minSizeY?s.minSizeY:1)*n.curRowHeight-n.margins[0]},Y=function(){return(s.minSizeX?s.minSizeX:1)*n.curColWidth-n.margins[1]};function C(e){switch(e.which){case 1:break;case 2:case 3:return}var t;return(u=n.draggable.enabled)&&(n.draggable.enabled=!1,r.$broadcast("gridster-draggable-changed",n)),v=e.pageX,p=e.pageY,l=parseInt(i.css("left"),10),d=parseInt(i.css("top"),10),h=i[0].offsetWidth,c=i[0].offsetHeight,s.sizeX,s.sizeY,t=e,i.addClass("gridster-item-moving"),i.addClass("gridster-item-resizing"),n.movingItem=s,s.setElementSizeX(),s.setElementSizeY(),s.setElementPosition(),n.updateHeight(1),r.$apply(function(){n.resizable&&n.resizable.start&&n.resizable.start(t,i,o)}),!0}function X(e){var t=n.curWidth-1;m=e.pageX,f=e.pageY;var u=m-v+w,C=f-p+z;w=z=0,v=m,p=f;var X=C,$=u;return g.indexOf("n")>=0&&(c-X<I()?(C=c-I(),z=X-C):d+X<b&&(z=X-(C=b-d)),d+=C,c-=C),g.indexOf("s")>=0&&(c+X<I()?(C=I()-c,z=X-C):d+c+X>y&&(z=X-(C=y-d-c)),c+=C),g.indexOf("w")>=0&&(h-$<Y()?(u=h-Y(),w=$-u):l+$<x&&(w=$-(u=x-l)),l+=u,h-=u),g.indexOf("e")>=0&&(h+$<Y()?(u=Y()-h,w=$-u):l+h+$>t&&(w=$-(u=t-l-h)),h+=u),i.css({top:d+"px",left:l+"px",width:h+"px",height:c+"px"}),function(e){var t=s.row,u=s.col,g=s.sizeX,m=s.sizeY,f=n.resizable&&n.resizable.resize,v=s.col;-1!==["w","nw","sw"].indexOf(a)&&(v=n.pixelsToColumns(l,!1));var p=s.row;-1!==["n","ne","nw"].indexOf(a)&&(p=n.pixelsToRows(d,!1));var w=s.sizeX;-1===["n","s"].indexOf(a)&&(w=n.pixelsToColumns(h,!0));var z=s.sizeY;-1===["e","w"].indexOf(a)&&(z=n.pixelsToRows(c,!0)),p>-1&&v>-1&&w+v<=n.columns&&z+p<=n.maxRows&&(!1!==n.pushing||0===n.getItems(p,v,w,z,s).length)&&(s.row=p,s.col=v,s.sizeX=w,s.sizeY=z);var b=s.row!==t||s.col!==u||s.sizeX!==g||s.sizeY!==m;(f||b)&&r.$apply(function(){f&&n.resizable.resize(e,i,o)})}(e),!0}function $(e){var t;return n.draggable.enabled!==u&&(n.draggable.enabled=u,r.$broadcast("gridster-draggable-changed",n)),w=z=0,t=e,i.removeClass("gridster-item-moving"),i.removeClass("gridster-item-resizing"),n.movingItem=null,s.setPosition(s.row,s.col),s.setSizeY(s.sizeY),s.setSizeX(s.sizeX),r.$apply(function(){n.resizable&&n.resizable.stop&&n.resizable.stop(t,i,o)}),!0}var S,M=null;this.enable=function(){M||(M=e.element('<div class="gridster-item-resizable-handler handle-'+g+'"></div>'),i.append(M)),(S=new t(M[0],C,X,$)).enable()},this.disable=function(){M&&(M.remove(),M=null),S.disable(),S=void 0},this.destroy=function(){this.disable()}}var l=[],d=n.resizable.handles;"string"==typeof d&&(d=n.resizable.handles.split(","));for(var h=!1,c=0,u=d.length;c<u;c++)l.push(new a(d[c]));this.enable=function(){if(!h){for(var e=0,t=l.length;e<t;e++)l[e].enable();h=!0}},this.disable=function(){if(h){for(var e=0,t=l.length;e<t;e++)l[e].disable();h=!1}},this.toggle=function(e){e?this.enable():this.disable()},this.destroy=function(){for(var e=0,t=l.length;e<t;e++)l[e].destroy()}}}]).factory("gridsterDebounce",function(){return function(e,t,i){var r;return function(){var n=this,s=arguments,o=i&&!r;clearTimeout(r),r=setTimeout(function(){r=null,i||e.apply(n,s)},t),o&&e.apply(n,s)}}}).directive("gridsterItem",["$parse","GridsterDraggable","GridsterResizable","gridsterDebounce","$rootScope",function(e,t,i,r,n){return{scope:!0,restrict:"EA",controller:"GridsterItemCtrl",controllerAs:"gridsterItem",require:["^gridster","gridsterItem"],link:function(s,o,a,l){var d,h=a.gridsterItem,c=l[0],u=l[1];if(s.gridster=c,h){var g=e(h);!(d=g(s)||{})&&g.assign&&(d={row:u.row,col:u.col,sizeX:u.sizeX,sizeY:u.sizeY,minSizeX:0,minSizeY:0,maxSizeX:null,maxSizeY:null},g.assign(s,d))}else d=a;u.init(o,c),o.addClass("gridster-item");for(var m=["minSizeX","maxSizeX","minSizeY","maxSizeY","sizeX","sizeY","row","col"],f={},v=[],p=function(t){var i;if("string"==typeof d[t])i=d[t];else if("string"==typeof d[t.toLowerCase()])i=d[t.toLowerCase()];else{if(!h)return;i=h+"."+t}v.push('"'+t+'":'+i),f[t]=e(i);var r=f[t](s);"number"==typeof r&&(u[t]=r)},w=0,z=m.length;w<z;++w)p(m[w]);var b="{"+v.join(",")+"}";s.$watchCollection(b,function(e,t){for(var i in e){var r=e[i];t[i]!==r&&(r=parseInt(r,10),isNaN(r)||(u[i]=r))}});var y,x=!0;$(window).resize(function(){x=!1,clearTimeout(y),y=setTimeout(function(){x=!0},1e3)}),s.$watch(function(){return u.row+","+u.col},function(){u.setPosition(u.row,u.col),f.row&&f.row.assign&&f.row.assign(s,u.row),f.col&&f.col.assign&&f.col.assign(s,u.col),x&&n.$broadcast("gridster-transition",u,c)}),s.$watch(function(){return u.sizeY+","+u.sizeX+","+u.minSizeX+","+u.maxSizeX+","+u.minSizeY+","+u.maxSizeY},function(){var e=u.setSizeX(u.sizeX,!0);e&&f.sizeX&&f.sizeX.assign&&f.sizeX.assign(s,u.sizeX);var t=u.setSizeY(u.sizeY,!0);t&&f.sizeY&&f.sizeY.assign&&f.sizeY.assign(s,u.sizeY),(e||t)&&(u.gridster.moveOverlappingItems(u),c.layoutChanged())});var I=new t(o,s,c,u,d),Y=new i(o,s,c,u,d),C=function(){},X=function(){I.toggle(!c.isMobile&&c.draggable&&c.draggable.enabled)};X(),s.$on("gridster-draggable-changed",X),s.$on("gridster-resizable-changed",C),s.$on("gridster-resized",C),s.$on("gridster-mobile-changed",function(){X()});var S=r(function(){s.$apply(function(){n.$broadcast("gridster-item-transition-end",u,c)})},50);return o.on(function(){var e=document.createElement("div"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var i in t)if(void 0!==e.style[i])return t[i]}(),S),s.$broadcast("gridster-item-initialized",u),s.$on("$destroy",function(){try{Y.destroy(),I.destroy()}catch(e){}try{c.removeItem(u)}catch(e){}try{u.destroy()}catch(e){}})}}}]).directive("gridsterNoDrag",function(){return{restrict:"A",link:function(e,t){t.addClass("gridster-no-drag")}}})});